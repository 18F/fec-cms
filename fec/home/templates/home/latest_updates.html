{% extends "base.html" %}
{% load wagtailcore_tags %}
{% load staticfiles %}
{% load filters %}

{% block title %}Latest updates | FEC{% endblock %}

{% block content %}

{% include 'partials/breadcrumbs.html' with page=page_context style='secondary' %}
<section class="content__section--extra">
  <div class="container">
    <h1>{{ page_context.title }}</h1>
    <p class="p--lead">Vestibulum id ligula porta felis euismod semper. Duis mollis, est non commodo luctus, nisi erat porttitor ligula, eget lacinia odio sem nec elit.</p>
  </div>
</section>
<section class="main__content--full data-container__wrapper">
  <div class="filters--horizontal">
    <form action="/updates" class="js-form-nav container">
        <div class="filter">
          <label class="label" for="publication-type">Publication type</label>
          <select id="publication-type" name="update_type" class="js-type">
            <option value="">All</option>
            <optgroup label="For media professionals">
              <option value="press-release" {% if 'press-release' in update_types %}selected{% endif %}>Press releases</option>
              <option value="weekly-digest" {% if 'weekly-digest' in update_types %}selected{% endif %}>Weekly digest</option>
            </optgroup>
            <optgroup label="For filers">
              <option value="fec-record" {% if 'fec-record' in update_types %}selected{% endif %}>FEC Record</option>
            </optgroup>
          </select>
        </div>
        {% if 'fec-record' in update_types or 'press-release' in update_types %}
          <div class="filter">
            <label class="label" for="categoryes">Subject</label>
            <select id="record-categories" name="category">
              <option value="">All</option>
              {% if 'fec-record' in update_types %}
                {% for cat in settings.CONSTANTS.record_page_categories.items %}
                  <option value="{{ cat.0 | slugify }}"
                    {% if cat.0|slugify == category %}selected{% endif %}>
                    {{ cat.1 }}</option>
                {% endfor %}
              {% elif 'press-release' in update_types %}
                {% for cat in settings.CONSTANTS.press_release_page_categories.items %}
                  <option value="{{ cat.0 | slugify }}"
                    {% if cat.0|slugify == category %}selected{% endif %}>
                    {{ cat.1 }}</option>
                {% endfor %}
              {% endif %}
          </select>
        </div>
        {% endif %}
        <div class="filter">
          <div class="combo combo--filter--mini">
            <label for="year" class="label">Year</label>
            <input id="year" class="combo__input" name="year" type="text" value="{{ year }}" placeholder="YYYY">
            <button type="submit" class="combo__button button button--standard button--go"><span class="u-visually-hidden">Filter</span></button>
          </div>
        </div>
    </form>
  </div>
  <div class="main">
    <div class="container">
      {% for update in updates %}
        {% include 'partials/update.html' with update=update %}
      {% endfor %}
      <div class="row">
        {% if updates.has_previous %}
            <a class="button button--standard button--previous" href="?page={{ updates.previous_page_number }}{% for key,value in request.GET.items %}{% ifnotequal key 'page' %}&amp;{{ key }}={{ value }}{% endifnotequal %}{% endfor %}"><span class="u-visually-hidden">Previous</span></a>
        {% endif %}
      <span>Page {{ updates.number }} of {{ updates.paginator.num_pages }}</span>
        {% if updates.has_next %}
            <a class="button button--standard button--next" href="?page={{ updates.next_page_number }}{% for key,value in request.GET.items %}{% ifnotequal key 'page' %}&amp;{{ key }}={{ value }}{% endifnotequal %}{% endfor %}"><span class="u-visually-hidden">Next</span></a>
        {% endif %}
      </div>
    </div>
  </div>
</section>
{% endblock %}
