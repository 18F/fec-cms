{% extends "base.html" %}
{% load wagtailcore_tags %}
{% load staticfiles %}
{% load filters %}

{% block title %}Latest updates | FEC{% endblock %}

{% block content %}

{% include 'partials/breadcrumbs.html' with page=page_context style='secondary' %}
<section class="content__section--extra">
  <div class="container">
    <h1>{{ page_context.title }}</h1>
    <p class="p--lead">Search or browse the latest information on the Commission and the federal campaign finance law.</p>
  </div>
</section>
<section class="main__content--full data-container__wrapper">
  <div class="filters--horizontal">
    <form action="/updates" class="js-form-nav container">
        <div class="filter">
          <fieldset>
            <legend class="label">For media professionals</legend>
              <input id="press-release-checkbox" type="checkbox" name="update_type" value="press-release" {% if 'press-release' in update_types %}checked{% endif %}>
              <label for="press-release-checkbox">Press release</label>
              <input id="digest-checkbox" type="checkbox" name="update_type" value="weekly-digest" {% if 'weekly-digest' in update_types %}checked{% endif %}>
              <label for="digest-checkbox">Weekly Digest</label>
            </fieldset>
            <fieldset>
              <legend class="label">For committees</legend>
              <input id="record-checkbox" type="checkbox" name="update_type" value="fec-record" {% if 'fec-record' in update_types %}checked{% endif %}>
              <label for="record-checkbox">FEC Record</label>
          </fieldset>
        </div>
          <div class="filter">
          {% if 'fec-record' in update_types or 'press-release' in update_types %}
            {% if 'press-release' in update_types %}
              <label class="label" for="record-categories">Press release subjects</label>
              <select id="record-categories" name="category">
                <option value="">All</option>
                {% for cat in settings.CONSTANTS.press_release_page_categories.items %}
                  <option value="{{ cat.0 | slugify }}"
                    {% if cat.0|slugify in category_list %}selected{% endif %}>
                    {{ cat.1 }}</option>
                {% endfor %}
              </select>
            {% endif %}
            {% if 'fec-record' in update_types %}
              <label class="label" for="release-categories">FEC Record subjects</label>
              <select id="release-categories" name="category">
                <option value="">All</option>
                {% for cat in settings.CONSTANTS.record_page_categories.items %}
                  <option value="{{ cat.0 | slugify }}"
                    {% if cat.0|slugify == category %}selected{% endif %}>
                    {{ cat.1 }}</option>
                {% endfor %}
              </select>
            {% endif %}
           {% else %}
            <label class="label" for="empty-select">Subjects</label>
            <select id="empty-select" name="category" disabled>
              <option value="">All</option>
            </select>
          {% endif %}
        </div>
        <div class="filter">
          <div class="combo combo--filter--mini">
            <label for="year" class="label">Year</label>
            <input id="year" class="combo__input" name="year" type="text" value="{{ year }}" placeholder="YYYY">
            <button type="submit" class="combo__button button button--standard button--go"><span class="u-visually-hidden">Filter</span></button>
          </div>
        </div>
    </form>
  </div>
  <div class="main">
    <div class="container">
      {% for update in updates %}
        {% include 'partials/update.html' with update=update %}
      {% endfor %}
      <div class="results-info">
        <span>Page {{ updates.number }} of {{ updates.paginator.num_pages }}</span>
        {% if updates.has_previous %}
            <a class="button button--standard button--previous" href="?page={{ updates.previous_page_number }}{% for key,value in request.GET.items %}{% ifnotequal key 'page' %}&amp;{{ key }}={{ value }}{% endifnotequal %}{% endfor %}"><span class="u-visually-hidden">Previous</span></a>
        {% endif %}
        {% if updates.has_next %}
            <a class="button button--standard button--next" href="?page={{ updates.next_page_number }}{% for key,value in request.GET.items %}{% ifnotequal key 'page' %}&amp;{{ key }}={{ value }}{% endifnotequal %}{% endfor %}"><span class="u-visually-hidden">Next</span></a>
        {% endif %}
      </div>
    </div>
  </div>
</section>
{% endblock %}
